<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªÙ„ÙØ²ÙŠÙˆÙ† Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ø±Ù…Ø¶Ø§Ù† 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0a0a0a; color: white; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        .header { background: #1a1a1a; padding: 15px; text-align: center; color: #ff3e3e; border-bottom: 2px solid #ff3e3e; }
        .main { display: flex; flex: 1; overflow: hidden; }
        #playlist { width: 300px; background: #111; overflow-y: auto; border-left: 1px solid #333; }
        .channel { padding: 12px; border-bottom: 1px solid #222; cursor: pointer; transition: 0.3s; font-size: 14px; }
        .channel:hover { background: #ff3e3e; color: white; }
        #video-area { flex: 1; background: black; display: flex; flex-direction: column; }
        video { width: 100%; height: 100%; background: black; }
        .input-bar { padding: 10px; background: #1a1a1a; display: flex; gap: 5px; }
        input { flex: 1; padding: 10px; border-radius: 5px; border: none; }
        button { padding: 10px 20px; background: #ff3e3e; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

<div class="header">ğŸŒ™ ØªÙ„ÙØ²ÙŠÙˆÙ† Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ù…Ø´Ø§Ù‡Ø¯Ø© Ù…Ù…ØªØ¹Ø©</div>

<div class="input-bar">
    <input type="text" id="urlInput" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· M3U Ù‡Ù†Ø§...">
    <button onclick="fetchChannels()">ØªØ´ØºÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª</button>
</div>

<div class="main">
    <div id="playlist">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</div>
    <div id="video-area">
        <video id="video" controls autoplay></video>
    </div>
</div>

<script>
    async function fetchChannels() {
        const url = document.getElementById('urlInput').value;
        const playlistEl = document.getElementById('playlist');
        playlistEl.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„... Ø§Ù†ØªØ¸Ø± Ø«ÙˆØ§Ù†ÙŠ";

        // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ³ÙŠØ· Ø£Ù‚ÙˆÙ‰ Ù„ØªØ®Ø·ÙŠ Ø­Ù…Ø§ÙŠØ© CORS
        const finalUrl = `https://cors-anywhere.herokuapp.com/${url}`;
        
        // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¥Ø°Ø§ Ù„Ù… ÙŠØ´ØªØºÙ„ØŒ Ø¬Ø±Ø¨ Ù‡Ø°Ø§ Ø§Ù„ÙˆØ³ÙŠØ· Ø§Ù„Ø¨Ø¯ÙŠÙ„ ÙÙŠ Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ:
        // const finalUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;

        try {
            const response = await fetch(finalUrl);
            const data = await response.text();
            parseM3U(data);
        } catch (e) {
            playlistEl.innerHTML = "ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø¬Ø±Ø¨ Ù…ØªØµÙØ­ Ø¢Ø®Ø±.";
        }
    }

    function parseM3U(content) {
        const lines = content.split('\n');
        const listEl = document.getElementById('playlist');
        listEl.innerHTML = "";
        
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].includes('#EXTINF')) {
                const name = lines[i].split(',')[1] || "Ù‚Ù†Ø§Ø©";
                const streamUrl = lines[i+1]?.trim();
                
                if (streamUrl && streamUrl.startsWith('http')) {
                    const div = document.createElement('div');
                    div.className = 'channel';
                    div.innerText = name;
                    div.onclick = () => play(streamUrl);
                    listEl.appendChild(div);
                }
            }
        }
    }

    function play(streamUrl) {
        const video = document.getElementById('video');
        if (Hls.isSupported()) {
            const hls = new Hls();
            hls.loadSource(streamUrl);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
        } else {
            video.src = streamUrl;
        }
    }
</script>
</body>
</html>

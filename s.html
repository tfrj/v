<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard - Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„</title>
    <style>
        :root { --blue: #007aff; --red: #ff3b30; --gray: #1c1c1e; }
        body { font-family: -apple-system, system-ui; background: #000; color: white; margin: 0; padding: 20px; }
        .panel { background: var(--gray); padding: 20px; border-radius: 20px; border: 1px solid #333; max-width: 450px; margin: auto; }
        h2 { text-align: center; margin-bottom: 20px; font-size: 22px; }
        input { width: 100%; padding: 15px; background: #2c2c2e; border: 1px solid #3d3d41; border-radius: 12px; color: white; margin-bottom: 15px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        button { padding: 12px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; -webkit-tap-highlight-color: transparent; }
        .btn-main { background: var(--blue); color: white; grid-column: span 2; padding: 18px; font-size: 16px; }
        .btn-action { background: #3a3a3c; color: white; font-size: 13px; }
        .btn-danger { background: var(--red); color: white; }
        .history { margin-top: 20px; border-top: 1px solid #333; padding-top: 15px; }
        .history-item { background: #2c2c2e; padding: 10px; border-radius: 8px; margin-bottom: 8px; font-size: 12px; display: flex; justify-content: space-between; align-items: center; }
        .history-item span { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 70%; }
        button:active { opacity: 0.7; transform: scale(0.98); }
    </style>
</head>
<body>

<div class="panel">
    <h2>ğŸ® Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
    
    <input type="url" id="vUrl" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§..." inputmode="url">
    
    <div class="grid">
        <button class="btn-main" onclick="publish('play')">Ø¨Ø« ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯ ğŸš€</button>
        <button class="btn-action" onclick="control('pause')">Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª â¸</button>
        <button class="btn-action" onclick="control('resume')">Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„ØªØ´ØºÙŠÙ„ â–¶ï¸</button>
        <button class="btn-action" onclick="control('mute')">ÙƒØªÙ… Ø§Ù„ØµÙˆØª ğŸ”‡</button>
        <button class="btn-action" onclick="control('unmute')">ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ğŸ”Š</button>
        <button class="btn-danger" style="grid-column: span 2;" onclick="control('refresh')">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¬Ù…ÙŠØ¹ ğŸ”„</button>
    </div>

    <div class="history">
        <p style="font-size: 14px; color: #888;">Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø®ÙŠØ±Ø©:</p>
        <div id="historyList"></div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAjTD-OJBUYewp5bqV0iVh4Rxp5zjBsU54",
        authDomain: "videos-5e336.firebaseapp.com",
        databaseURL: "https://videos-5e336-default-rtdb.firebaseio.com",
        projectId: "videos-5e336",
        storageBucket: "videos-5e336.firebasestorage.app",
        messagingSenderId: "300218651134",
        appId: "1:300218651134:web:4bd24df8e555e62828f0af"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Ø¯Ø§Ù„Ø© Ø¨Ø« Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯
    window.publish = function() {
        const url = document.getElementById('vUrl').value.trim();
        if(!url) return alert("Ø§Ù„Ø±Ø§Ø¨Ø· ÙØ§Ø±Øº!");
        
        const ts = Date.now();
        set(ref(db, 'liveVideo'), { url: url, timestamp: ts, action: 'new' });
        addToHistory(url);
        document.getElementById('vUrl').value = "";
    };

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø¥ÙŠÙ‚Ø§ÙØŒ ØµÙˆØªØŒ ØªØ­Ø¯ÙŠØ«)
    window.control = function(act) {
        set(ref(db, 'controls'), { action: act, timestamp: Date.now() });
    };

    function addToHistory(url) {
        const list = document.getElementById('historyList');
        const item = document.createElement('div');
        item.className = 'history-item';
        item.innerHTML = `<span>${url}</span><button class="btn-action" onclick="document.getElementById('vUrl').value='${url}'; publish();">Ø¨Ø«</button>`;
        list.prepend(item);
    }
</script>
</body>
</html>
